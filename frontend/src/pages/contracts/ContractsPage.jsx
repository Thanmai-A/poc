import React,{useEffect,useState} from 'react'; import TopNav from '../../components/TopNav'; import PrivateRoute from '../../components/PrivateRoute'; import api from '../api'; import { Container, Card, Table, Form, Button } from 'react-bootstrap';
export default function ContractsPage(){ const [contracts,setContracts]=useState([]); const [file,setFile]=useState(null); const [title,setTitle]=useState(''); const [vendorId,setVendorId]=useState(''); const load=async()=>{ try{ const {data}=await api.get('/contracts'); setContracts(data);}catch{} }; useEffect(()=>{load();},[]); const upload=async(e)=>{ e.preventDefault(); const fd=new FormData(); fd.append('file',file); fd.append('title',title); fd.append('vendor_id',vendorId); await api.post('/contracts',fd,{headers:{'Content-Type':'multipart/form-data'}}); setFile(null); setTitle(''); setVendorId(''); await load(); };
  return (<PrivateRoute allow={['admin','procurement']}><TopNav/><Container><Card className="p-3 mb-3"><h5>Upload Contract</h5><Form onSubmit={upload}><div className="d-flex gap-2"><Form.Control placeholder="Title" value={title} onChange={e=>setTitle(e.target.value)} required /><Form.Control placeholder="Vendor ID" value={vendorId} onChange={e=>setVendorId(e.target.value)} required /><Form.Control type="file" onChange={e=>setFile(e.target.files[0])} required /><Button type="submit">Upload</Button></div></Form></Card><Card className="p-3"><h5>Contracts</h5><Table striped bordered hover size="sm"><thead><tr><th>ID</th><th>Title</th><th>Vendor</th><th>Status</th><th>Expiry</th></tr></thead><tbody>{contracts.map(c=>(<tr key={c.id}><td>{c.id}</td><td>{c.title}</td><td>{c.vendor?.name||c.vendor_id}</td><td>{c.status}</td><td>{c.expiry_date}</td></tr>))}</tbody></Table></Card></Container></PrivateRoute>); }
