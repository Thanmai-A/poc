import React,{useEffect,useState} from 'react'; import TopNav from '../../components/TopNav'; import PrivateRoute from '../../components/PrivateRoute'; import api from '../api'; import { Container, Card, Table, Form, Button } from 'react-bootstrap';
export default function MessagesPage(){ const [messages,setMessages]=useState([]); const [content,setContent]=useState(''); const [receiver,setReceiver]=useState(''); const load=async()=>{ try{ const {data}=await api.get('/messages'); setMessages(data);}catch{} }; useEffect(()=>{load();},[]); const send=async(e)=>{ e.preventDefault(); await api.post('/messages',{to_user_id:receiver,subject:'Message',body:content,channel:'general'}); setContent(''); setReceiver(''); await load(); };
  return (<PrivateRoute allow={['admin','procurement','finance','vendor']}><TopNav/><Container><Card className="p-3 mb-3"><h5>Send Message</h5><Form onSubmit={send}><div className="d-flex gap-2"><Form.Control placeholder="Receiver ID" value={receiver} onChange={e=>setReceiver(e.target.value)} required /><Form.Control placeholder="Message" value={content} onChange={e=>setContent(e.target.value)} required /><Button type="submit">Send</Button></div></Form></Card><Card className="p-3"><h5>Inbox</h5><Table striped bordered hover size="sm"><thead><tr><th>ID</th><th>From</th><th>To</th><th>Content</th></tr></thead><tbody>{messages.map(m=>(<tr key={m.id}><td>{m.id}</td><td>{m.from_user_id}</td><td>{m.to_user_id||'-'}</td><td>{m.body}</td></tr>))}</tbody></Table></Card></Container></PrivateRoute>); }
